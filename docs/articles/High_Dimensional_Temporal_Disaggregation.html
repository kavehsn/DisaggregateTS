<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Temporal Disaggregation of IBM's GHG Emissions ‚Ä¢ DisaggregateTS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Temporal Disaggregation of IBM's GHG Emissions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DisaggregateTS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/High_Dimensional_Temporal_Disaggregation.html">Temporal Disaggregation of IBM's GHG Emissions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kavehsn/DisaggregateTS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Temporal Disaggregation of IBM's GHG Emissions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kavehsn/DisaggregateTS/blob/HEAD/vignettes/High_Dimensional_Temporal_Disaggregation.Rmd" class="external-link"><code>vignettes/High_Dimensional_Temporal_Disaggregation.Rmd</code></a></small>
      <div class="d-none name"><code>High_Dimensional_Temporal_Disaggregation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, we demonstrate how to use the
<strong>DisaggregateTS</strong> package to perform temporal
disaggregation of IBM‚Äôs greenhouse gas (GHG) emissions data. The goal is
to estimate quarterly GHG emissions based on annual data, leveraging
high-frequency economic indicators.</p>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<p>By focusing on emissions per unit of economic output, carbon
intensity accounts for the fact that larger organizations or economies
may naturally produce more emissions simply due to scale. This allows
for a fair comparison of sustainability performance across different
entities, regardless of size.</p>
<p>Accurate and timely carbon accounting and the development of robust
measurement frameworks are essential for effective emission reduction
strategies and the pursuit of sustainable development goals. While
carbon accounting frameworks offer valuable insights into emissions
quantification, they are not without limitations. One of those
limitations is the frequency with which this information is released,
generally at an annual frequency, while most companies‚Äô economic
indicators are made public on a quarterly basis. This is a perfect
example in which temporal disaggregation can be used to bridge the gap
between data availability and prompt economic and financial
analyses.</p>
<p>In this application, the variable of interest is the GHG emissions
for IBM between Q3 2005 and Q3 2021, at annual frequency, resulting in
17 data points (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêò</mi><mo>‚àà</mo><msup><mi>‚Ñù</mi><mn>17</mn></msup></mrow><annotation encoding="application/x-tex">\mathbf{Y} \in \mathbb{R}^{17}</annotation></semantics></math>).
For the high-frequency data, we used the balance sheet, income
statement, and cash flow statement quarterly data between Q3 2005 and Q3
2021, resulting in 68 data points for the 112 variables (after
filtering). We remove variables that have a pairwise correlation higher
than 0.99, resulting in a filtered dataset with 112 variables
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêó</mi><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mn>68</mn><mo>√ó</mo><mn>112</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{X} \in \mathbb{R}^{68 \times 112}</annotation></semantics></math>).</p>
<p>In this example, we employ the adaptive LASSO method
(<code>method = "adaptive-spTD"</code>) to select the best variables
that can be used to recover the high-frequency observations, and we
apply the <code>aggMat = "first"</code> aggregation method.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>We start by loading the required packages and data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DisaggregateTS</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the combined data from the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract Data_Y and Data_X from the combined data</span></span>
<span><span class="va">Data_Y</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">Data_Y</span></span>
<span><span class="va">Data_X</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">Data_X</span></span>
<span></span>
<span><span class="co"># Select IBM GHG data and dates for Q3 2005 - Q3 2021</span></span>
<span><span class="va">Dates</span> <span class="op">&lt;-</span> <span class="va">Data_Y</span><span class="op">$</span><span class="va">Dates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">Data_Y</span><span class="op">$</span><span class="va">IBM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># HF data available from 12-2004 (observation 21) up to 09-2021 (observation 88)</span></span>
<span><span class="va">Dates_Q</span> <span class="op">&lt;-</span> <span class="va">Data_X</span><span class="op">$</span><span class="va">Dates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span><span class="op">:</span><span class="fl">88</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Data_X</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span><span class="op">:</span><span class="fl">88</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">as.numeric</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in lapply(X = X, FUN = FUN, ...): NAs introduced by coercion</span></span>
<span></span>
<span><span class="co"># Remove columns containing NAs</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> </span>
<span></span>
<span></span>
<span><span class="co"># Remove highly correlated variables (pairwise correlation &gt;= 0.99)</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">tmp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0.99</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="temporal-disaggregation">Temporal Disaggregation<a class="anchor" aria-label="anchor" href="#temporal-disaggregation"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">C_sparse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disaggregate.html">disaggregate</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>  aggMat   <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  aggRatio <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  method   <span class="op">=</span> <span class="st">"adaptive-spTD"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Temporally disaggregated time series</span></span>
<span><span class="va">Y_HF</span> <span class="op">&lt;-</span> <span class="va">C_sparse</span><span class="op">$</span><span class="va">y_Est</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span>  <span class="co"># Adjust margins for better spacing</span></span>
<span></span>
<span><span class="co"># Plot the temporal disaggregated data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dates_Q</span>, <span class="va">Y_HF</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, ylab <span class="op">=</span> <span class="st">"GHG emissions"</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>     lwd <span class="op">=</span> <span class="fl">2</span>, cex.lab <span class="op">=</span> <span class="fl">1.4</span>, cex.axis <span class="op">=</span> <span class="fl">1.2</span>, main <span class="op">=</span> <span class="st">"Temporal Disaggregation of GHG Emissions"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a legend with adjusted font size and position</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, inset <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>       legend <span class="op">=</span> <span class="st">"Temporal disaggregated observations"</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">19</span>, </span>
<span>       cex <span class="op">=</span> <span class="fl">1.2</span>, pt.cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="High_Dimensional_Temporal_Disaggregation_files/figure-html/plot-results-1.png" width="768"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kaveh Salehzadeh Nobari, Luke Mosley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
